import bs4 as bs
import urllib.request

URL = input('Please enter the exploit-db url: ')
print()

source = urllib.request.urlopen(URL).read()
soup = bs.BeautifulSoup(source, features="html.parser")

# get exploit title
print('Title:', soup.title.text)

# record EDB-ID, CVE, Author, Type, Platform, Date into processed_info array
info = soup.find_all('h6', class_="stats-title")
processed_info = []
for i in info:
    processed_info.append(i.text.strip())

# check if verified
edb_verified = soup.find('div', class_="stats h5 text-center")
child = edb_verified.findChild('i')
style = child["style"]

ans = 'unknown'
if style == 'color: #96b365':
    ans = 'True'
elif style == 'color: #ec5e10':
    ans = 'False'

# print info
if processed_info[1] == 'N/A':
    print('CVE: N/A')
else:
    print(f'CVE: CVE-{processed_info[1]}')
print('EDB Verified:', ans)
print()